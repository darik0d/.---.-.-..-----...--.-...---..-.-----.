# Cracking the Vigenere Cipher

## Oplossing

Rauwe ontcijferde tekst:
```text
DOEMAARGEWOONALSOFIKERNIETBENZEIIKTEGENHETKINDDATVANDEHONGERAANHETSTERVENWASENDATIKPROBEERDETEFOTOGRAFERENIKWASZENUWACHTIGENWOUDATIKEENPILTESLIKKENHADDIEHETBEVENVANMIJNHANDENZOUSTOPPENERGENSVOELDEIKDATDITMIJNFOTOZOUWORDENDEFOTODIEFOTODIEMIJNGROTEDOORBRAAKZOUINLUIDENWAARDOORIKMIJNMARKTWAARDEKONOPDRIJVENDIEHETMIJZOUTOESTAANDEGROTEBAASVANREUTERSTEVRAGENOFHIJMIJEENSTERUGKONBELLENWANNEERHETMIJBETERPASTEEENFOTOGRAAFVOELTZOIETSDEWERELDBEROEMDEHENRICARTIERBRESSONVOELDEHETTOENHIJDATJONGETJEMETDETWEEWIJNFLESSENINDEPARIJSERUEMOUFFETARDVASTLEGDEELLIOTERWITTVOELDEHETTOENDIENEGERVOORHETOOGVANDECAMERAZIJNTONGUITSTAKALFREDSTIEGLITZVOELDEHETTOENDATMOOIEMEISJEMETDENOGMOOIEREVINGERSHAARJASHADDICHTGEKNOOPTOPHETJUISTEMOMENTENEDWARDSTEICHENHADHONDERDENKIEKJESVANGRETAGARBOGESCHOTENMAARHADNOGTIJDENSHETSCHERPSTELLENVANZIJNLENSGEVOELDDITWORDTHETENIGEWARESCHONEULTIEMEPORTRETVANDEGODINHETZELFDEALSWATIKVOELDEMETHETUITGEHONGERDEKINDINMIJNVIZIERZALIGOPAVONDENDIENERGENSVOORDEUGENDANVOORFLAUWEKULHOORJEWELEENSBEWERENDATFOTOGRAFIEVEELZONIETALLESMETGELUKVANDOENHEEFTENDANBEGINNENZEOVERDEMAKERVANDEFOTODIEIEDEREENKENTHETNAAKTEMEISJEVERBRANDRENNENDMETDEARMENOPENCHRISTUSMETEENKUTALSDEFOTOGRAAFNIETTOEVALLIGOPDEPLAATSVANHETNAPALMBOMBARDEMENTWASGEWEESTZOREDENERENZEDANHADHIJNOOITDIEFOTOKUNNENSCHIETENENDUSHEEFTHETTEMAKENMETGELUKTJAUGAATTOCHNIETMOPPERENDATIKHETGELUKHADDATERVOORMIJNOGENEENKINDLAGTECREPERENIKHADDATGELUKNIETIKHADDATTALENTZOALSROBERTCAPAHETTALENTHADDENEUSHADMETZIJNCAMERAOPDEPLAATSTEZIJNWAAREENSOLDAATDEHERSENENUITDEKOPWERDENGESCHOTENGELUKZEGGENBERGBEKLIMMERSDIEEENMOORDENDESTEENLAWINEOPDRIECENTIMETERVANHUNSMIKKELZAGENVOORBIJRAZENGELUKISOPDENDUUREENKWESTIEVANBEKWAAMHEIDIKWEETDATZEDAARGELIJKINHEBBENI
```

Final String:
```text
DOE MAAR GEWOON ALSOF IK ER NIET BEN ZEI IK TEGEN 
HET KIND DAT VAN DE HONGER AAN HET STERVEN WAS EN DAT IK PROBEERDE 
TE FOTOGRAFEREN IK WAS ZENUWACHTIG EN WOU DAT
IK EEN PIL TE SLIKKEN HAD DIE
HET BEVEN VAN MIJN HANDEN ZOU STOPPEN ERGENS VOELDE IK DAT DIT MIJN FOTO ZOU WORDEN DE FOTO
DIE FOTO DIE MIJN GROTE DOORBRAAK ZOU INLUIDEN WAARDOOR IK MIJN MARKTWAARDE KON OPDRIJVEN DIE HET MIJ ZOU 
TOESTAAN DE GROTE BAAS VAN REUTERSTE VRAGEN OF HIJ MIJ EENS TERUG KON BELLEN WANNEER HET MIJ BETER PAST 
EEEN FOTOGRAAF VOELT ZOIETS DEWERELDBEROEMDE HENRI CARTIERBRESSON VOELDE HET TOEN HIJ DAT JONGETJE MET 
DE TWEE WIJNFLESSEN IN DE PARIJ SERUEMOUFFETARD VASTLEG DEEL LIOTER WITT VOELDE HET TOENDIENEGER VOOR HET OOG 
VAN DE CAMERAZIJN TONGUITSTAKALFREDSTIEGLITZ
VOELDE HET TOEN DAT MOOIE MEISJE MET DE NOG MOOIERE VINGERSHAARJAS
HAD DICHTGEKNOOPT OP HET JUISTE MOMENT EN EDWARD STEICHENHADHONDERDENKIEKJESVANGRETAGARBOGESCHOTEN MAAR 
HAD NOG TIJDENS HET SCHERPSTELLEN VAN ZIJN LENS GEVOELD DIT WORDT HET ENIGE WARESCHONE ULTIEME PORTRET 
VAN DE GOD IN HET ZELFDE ALS WAT IK VOELDE MET HET UITGEHONGERDE KIND IN MIJN 
VIZIER ZALIG OP AVOND EN DIENERGENS VOOR DEUGEN DAN VOOR FLAUWEKUL HOOR JE WELEENS 
BEWEREN DAT FOTOGRAFIE VEEL ZONIET ALLES MET GELUK VAN DOEN HEEFT EN DAN BEGINNEN ZE OVER DE MAKER 
VAN DE FOTO DIE IEDEREEN KENT HET NAAKTE MEISJE VERBRANDRENNEND MET DE ARMEN OPEN CHRISTUS MET 
EEN KUT ALS DE FOTOGRAAF NIET TOEVALLIG OP DE PLAATS VAN HET NAPALMBOMBARDEMENT WAS GEWEEST 
ZO REDENEREN ZE DAN HAD HIJ NOOIT DIE FOTO KUNNEN SCHIETEN EN DUS HEEFT 
HET TE MAKEN MET GELUK TJAU GAAT TOCH NIET MOPPEREN DAT IK HET GELUK HAD DAT ER VOOR MIJN OGEN EEN 
KIND LAG TE CREPEREN IK HAD DAT GELUK NIET IK HAD DAT TALENT ZOALS ROBERT CAPAHET TALENT HADDENEUS HAD MET ZIJN
CAMERA OP DE PLAATS TE ZIJN WAAR EEN SOLDAAT DE HERSENEN UIT DE KOP WERDEN GESCHOTEN 
GELUK ZEGGEN BERG BE KLIMMERS DIE EEN MOORDENDE STEENLAWINE OPDRIECENT I METER VAN HUN SMIKKEL ZAGEN
VOORBIJ RAZEN GELUK IS OP DEN DUUR EEN KWESTIE VAN BEKWAAMHEID IK WEET DAT ZE DAAR GELIJK IN HEBBEN I
```

Van het boek 'Problemski Hotel' van 'Dimitri Verhulst'

## oplossing-methode
Eerst heb ik de Enkelkolom Transpositie achterhaalt.
Vervolgens [simon Singh cracking the vigenere cipher](https://www.simonsingh.net/The_Black_Chamber/vigenere_cracking_tool.html)
gebruikt om de laatste sleutel (VERHULST) en text te achterhalen.

Tot slot, heb ik een gelijkwaardig systeem geimplementeerd zoals de Simon Singh vigenere cipher cracking tool, zodat het automatisch de tekst
ontcijferd.

### Enkelkolom Transpositie
Een eigenschap van Vigenere is dat deze cipher veel herhaling heeft (vooral woord delen van lengte 3).
Deze eigenschap wordt geÃ«xploiteerd voor het oplossen van de Enkelkolom Transpositie.
Hierbij wordt elke Enkelkolom Transpositie uitgevoerd. Vervolgens wordt er door middel van **Suffix Arrays** ([suffix array explanation](https://cp-algorithms.com/string/suffix-array.html))
makkelijk gezocht naar common prefixes (CP) in de tekst. Als metric pakken we de Enkelkolom Transpositie zijn CP. We nemen de decryption dat de hoogste CP hoeveelheid heeft van 
lengte 3. Gelukkig voor ons kwam dit na de eerste poging uit op de ontcijfering van de Enkelkolom Transpositie.

### Vigenere Cipher
De vigenere cijfer voert steeds een Ceaser Cipher uit, zodat voor iedere groep posities (met deelfde mod key lengte), de meest voorkomende character is gelijkgesteld aan 'E'.
We maken wel gebruik van het feit dat we de key lengte weten (kan via trial en error/ Simon Singh tool). Door steeds de meest frequente character te linken aan de chracter 'E', komen we snel tot het jusite antwoord.

### Concrete functies

- ``CommonPrefixCounter.py`` zorgt ervoor, dat gegeven een string, het makkelijk is te tellen hoe vaak dat een zekere 3-letter combinatie voorkomt.
- ``TranspositionCipher.py`` voert de Enkelkolom transpositie encrypt en decrypt uit.
- ``VigenereSolver.py`` kraak de vigenere zelf, door steeds Cesar ciphers uit te voeren, en steeds de meest frequente character gelijk te stellen aan 'E'
- ``main.py`` hier is de functie ``find_highest_cp``, deze functie voert alle mogelijke Enkelkolom transposities uit, en behoudt de key, van de resulterende transpositie decryptie die de meeste common prefixes heeft. Deze file voert ook de hele decryptie uit

### References
- Course Material Code Theory from Professor S. Symens
- Vigenere cracking tool (https://www.simonsingh.net/The_Black_Chamber/vigenere_cracking_tool.html) from Simon Singh 
- Suffix Array (https://cp-algorithms.com/string/suffix-array.html) Mainly from Jakobkogler